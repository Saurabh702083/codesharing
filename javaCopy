Once's the file is stored in the S3 bucket we have to read and file data and store it into Operation DB
Step 1. Read the file BankCode from S3 bucket.
Step 2. Call Admin Service:-
Depending upon bankcode or bankName we have to get the file configuration for that particular bank from Admin Service.
We can get the details of file config from RECON_FILE_CONFIG table in Admin DB. These Table contains details of BANK_ID, FILE_TYPE ,FILE_DELIMETER ,FILE_HEADER_ROW , FILE_READ_FROM, FILE_ENCRYPTED etc.
Step 3. Decryption of file.
If the for the particular bankCode ,its file are encrypted then we have to first decrypt that file. And for decryption we will get key and type of encryption from RECON_FILE_CONFIG table. If file is not encrypted then we can directly move to next sept.
Step 4. Read the File details:-
Depending upon bank file we have to pars the data. Every bank have different file format and data inside the file have different format.
So to read the data we have to fellow the files config details for particular bank like from which row we will get bank id, bank Header ,ATRN details , transaction details etc.
Step 5. Store in DB:-
We have to store the read data to RECON_FILE_DTLS Table.
To store the Data  we can use Kafka that will store the data in bundle. Data are stored in particular assigned row.
Step 6. Acknowledge in s3.
Once the file is read and data is stored in DB we have to crate Acknowledge file in S3 that will keep the status of the file.


------------------+--

Project Story: Recon File Processing

Objective:

The purpose of this project is to automate the processing of reconciliation (Recon) files uploaded to an S3 bucket by various banks. The goal is to read, decrypt (if necessary), and parse these files, then store the parsed data in the Operations database (DB) using Kafka. Additionally, we generate an acknowledgment file in the S3 bucket after successful processing.


---

Functional Flow:

1. File Upload and Reading:

Recon files are uploaded by the bank to the designated S3 bucket.

The system monitors the S3 bucket for new files.

Once a file is detected, the system extracts the bank code from the file name.



2. Admin Service Call:

The extracted bank code is used to call the Admin Service.

Admin Service retrieves file configuration details from the RECON_FILE_CONFIG table in the Admin DB. These details include:

Bank ID

File Type

File Delimiter

Header Row Indicator

Data Read Starting Point

Encryption Status (if applicable)


If the file is encrypted, the configuration also includes the decryption key and the decryption method.



3. File Decryption (if required):

If the configuration indicates that the file is encrypted, the system proceeds to decrypt it.

The decryption key and method obtained from the Admin Service are used to perform decryption.

If the file is not encrypted, the system skips this step.



4. File Parsing:

Once decrypted (if needed), the file is parsed according to the configuration for that specific bank.

The parsing logic accounts for the file type, delimiter, header row, and data read starting point as specified in the config.

Extracted data includes essential details like Bank ID, Bank Hash, ATRN details, and transaction data.



5. Data Storage:

After successful parsing, the data is stored in the RECON_FILE_DTLS table in the Operations DB.

The data is sent to the DB in bundles using Kafka, which handles batch processing for efficiency.



6. Acknowledgment Generation:

Once data is successfully stored, an acknowledgment file is generated.

This file contains the status of the processing and is uploaded to the S3 bucket as confirmation.





---

Error Handling:

If file decryption fails, an error log is generated



